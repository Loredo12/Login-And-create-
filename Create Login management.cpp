#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <conio.h>
#include <windows.h>
#include <ctype.h>
#include <time.h>

struct Account {
    char username[50];
    char password[50];
    char role[20];
    char course[50];
    char firstName[50];
    char lastName[50];
    char Department[50];
    char idNumber[20];
    char email[50];
};




void menu();
int createAccount();
void loginAccount();
void forgotPassword();
void inputPassword(char *pass);
void loadingScreen();
void clear_stdin();
void EDUC_Regular_Schedule();
void BSOA_Regular_Schedule();
void schduleDepartment();
void generateId(const char* role, const char* department, char* idNumber);

int main() {
    menu();
    return 0;
}





void EDUC_Regular_Schedule() {
	printf("\n                   |~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|                                              WEEKLY SCHEDULE                                                   |×|\n");
	printf("                     |×|                                              COURSE: EDUC FIRST YEAR                                          |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|          ?     ?     ?     ?     ?     ?     ?     ?      ?      ?      ?      ?      ?      ?      ?      ?      ?   |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~×~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~~~×~~~~~~~~+~~~~~~~~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|      TIME       |     MONDAY   |    TUESDAY    |   WEDNESDAY   |   THURSDAY    |     FRIDAY    |    SATURDAY   |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    7:00-8:00    |              |               |               |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    8:00-8:45    | TLE101 LAB   |               |               |               |               | FCC101 404    |×|\n");
    printf("                     |×|                 | CL2 MAIN     |               |               |               |               | MAIN          |×|\n");   
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    8:45-9:00    |                                  BREAK TIME                                                  |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|   9:00-10:00    |              |               |               |               |               |               |×|\n");
    printf("                     |×|                 | TLE101 LAB   |               |               |               |               | FCC101 404    |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~× CL2 MAIN     ×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~× MAIN          |×|\n");
    printf("                     |×|   10;00-10:45   |              |               |               |               |               |               |×|\n");
    printf("                     |×|                 |              |               |               |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
    printf("                     |×|   10:45-11:15   |                                  LUNCH BREAK                                                 |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|   11:15-12:00   |              |               |               |               |               |               |×|\n");
    printf("                     |×|                 |              |               | GE102 |104    |               |               | NSTP1 403     |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~× ANNEX         ×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~× MAIN          |×|\n");
	printf("                     |×|    12:00-1:00   |              |               |               |               |               |               |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~×              ×               ×               ×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×               |×|\n");
	printf("                     |×|    1:00-2:00    | TLE102 404     | GE102 403   |               |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~× MAIN         × MAIN          |~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    2:00-2:45    |              |               | PATHFIT1 104  |               |               | FCC102 404    |×|\n");
    printf("                     |×|                 |              |               | ANNEX         |               |               | MAIN          |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
    printf("                     |×|    2:45-3:00    |                                  BREAK TIME                                                  |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    3:00-4:00    | PLS 102      |               | PATHFIT1 104  |               |               |               |×|\n");
    printf("                     |×|                 | ANNEX        | TLE101 LEC    | ANNEX         |               |               | FCC102 404    |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~× 403-MAIN      ×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~× MAIN          |×|\n");
    printf("                     |×|    4:00-4:45    |              |               | GE103 104     |               |               |               |×|\n");
    printf("                     |×|                 |              |               | ANNEX         |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    4:45-5:15    |                                  BREAK TIME                                                  |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
    printf("                     |×|    5:15-6:00    |              |               |               |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~× GE103 104     ×               ×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
    printf("                     |×|    6:00-7:00    |              |               | ANNEX         |               |               |               |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|×|\n");
	printf("                     |~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|\n");

}







void BSOA_Regular_Schedule() {
	printf("\n                   |~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|                                              WEEKLY SCHEDULE                                                   |×|\n");
	printf("                     |×|                                              COURSE: BSOA                                                      |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|          ?     ?     ?     ?     ?     ?     ?     ?      ?      ?      ?      ?      ?      ?      ?      ?      ?   |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~×~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~~~×~~~~~~~~+~~~~~~~~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|      TIME       |     MONDAY   |    TUESDAY    |   WEDNESDAY   |   THURSDAY    |     FRIDAY    |    SATURDAY   |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    7:00-8:00    |              |               |               |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    8:00-8:45    |              |               |               |               |               |  NSTP1 404-   |×|\n");
    printf("                     |×|                 |              |               |               |               |               |  ROOM  MAIN   |×|\n");   
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    8:45-9:00    |                                  BREAK TIME                                                  |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|   9:00-10:00    |              |               |               |               |               |  NSTP1 404-   |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×  ROOM MAIN    |×|\n");
    printf("                     |×|   10;00-10:45   |              |               |               |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
    printf("                     |×|   10:45-11:15   |                                  LUNCH BREAK                                                 |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|   11:15-12:00   |              |               |               |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×  GE104 104-   ×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×  GE101 404-   |×|\n");
	printf("                     |×|    12:00-1:00   |              |               |  ANNEX        |               |               |  MAIN.        |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×               ×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×               |×|\n");
	printf("                     |×|    1:00-2:00    |              | QACC102LEC    |               |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~× 411-MAIN      |~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    2:00-2:45    |              |               | PATHFIT 104   |               |               |               |×|\n");
    printf("                     |×|                 |              |               | ANNEX         |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
    printf("                     |×|    2:45-3:00    |                                  BREAK TIME                                                  |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    3:00-4:00    |  PLS 102     |               | PATHFIT 104   |               |               |               |×|\n");
    printf("                     |×|                 |  ANNEX       | QACc102LEC    | ANNEX         |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~× CL2-MAIN      ×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
    printf("                     |×|    4:00-4:45    | QACC101 102- |               | GE2 104       |               |               |               |×|\n");
    printf("                     |×|                 | ANNEX        |               | ANNEX         |               |               |               |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
	printf("                     |×|    4:45-5:15    |                                  BREAK TIME                                                  |×|\n");
    printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~~|×|\n");
    printf("                     |×|    5:15-6:00    | QACC101 102- | QACC102LEC    | GE2 104       |               |               |               |×|\n");
    printf("                     |×|                 | ANNEX        | ANNEX         | ANNEX         |               |               |               |×|\n");
    printf("                     |×|    6:00-7:00    |              |               |               |               |               |               |×|\n");
	printf("                     |×|~~~~~~~~~~~~~~~~~×~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|~~~~~~~~~~~~~~~|×|\n");
	printf("                     |~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|\n");
}










void clear_stdin() {
    int c;
    while ((c = getchar()) != '\n' && c != EOF) {}
}








void menu() {
    char choice;

    while (1) {
        system("cls");
        printf("=====================================================\n");
        printf("|          PHILTECH SCHOOL MANAGEMENT SYSTEM        |\n");
        printf("=====================================================\n");
        printf("|           [1] Create Account                      |\n");
        printf("|           [2] Login                               |\n");
        printf("|           [3] Forgot Password                     |\n");
        printf("|           [4] Exit                                |\n");
        printf("-----------------------------------------------------\n");
        printf("Enter your choice: ");
        choice = getch();
        printf("%c\n", choice);

        switch (choice) {
            case '1': createAccount(); break;
            case '2': loginAccount(); break;
            case '3': forgotPassword(); break;
            case '4':
                printf("\nThank you for using the system!\n");
                exit(0);
            default:
                printf("\n? Invalid input! Please press any key to try again.\n");
                getch();
                continue;
        }

        printf("\nPress any key to return to main menu...");
        getch();
    }
}












int createAccount() {
    char firstName[50], lastName[50], birthD[20], sex[10], address[200],email[50];
    char username[50], password[50], confirmPassword[50];
    char role[20], course[50],department[50];
    char idNumber[20];
    FILE *fp;

    // FIRST NAME
    while (1) {
        system("cls");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                       * --------------------- / ---------------- /                       [ 9 ] Back  |\n");
        printf("                  |                              Personal Information     Account information     Position                               |\n");
        printf("                  +====================================================================================================================+\n\n");
        printf("                                                                   Personal Information\n\n");

        printf("\n\n                                  Enter firstname:\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |                                                                                          |\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");

        printf("\n                                  Type here: ");
        if (scanf(" %[^\n]", firstName) != 1) { clear_stdin(); continue; }

        if (strcmp(firstName, "9") == 0) return 0;

        if (strlen(firstName) < 2) {
            printf("\n(System): Firstname too short! Try again.\n");
            getch();
            continue;
        }

        int boxWidth = 90;
        int textLen = strlen(firstName);
        int leftPadding = (boxWidth - textLen) / 2;

        system("cls");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                       * --------------------- / ---------------- /                       [ 9 ] Back  |\n");
        printf("                  |                              Personal Information     Account information     Position                               |\n");
        printf("                  +======================================================================================================================+\n");
        printf("                                                                   |Personal Information|\n");
        printf("                                                                   +====================+\n");
        printf("\n\n                                  Enter FIRSTNAME:\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |%*s%s%*s|\n", leftPadding, "", firstName, boxWidth - textLen - leftPadding, "");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        break;
    }

    // LAST NAME
    while (1) {
        printf("\n\n                                  Enter lastname:\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |                                                                                          |\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("\n                                  Type here: ");
        if (scanf(" %[^\n]", lastName) != 1) { clear_stdin(); continue; }

        if (strlen(lastName) < 2) {
            printf("\n(System): Lastname too short! Try again.\n");
            getch();
            continue;
        }

        int boxWidth = 90;
        int textLen = strlen(lastName);
        int leftPadding = (boxWidth - textLen) / 2;

        system("cls");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                       * --------------------- / ---------------- /                       [ 9 ] Back  |\n");
        printf("                  |                              Personal Information     Account information     Position                               |\n");
        printf("                  +======================================================================================================================+\n");
        printf("                                                                   |Personal Information|\n");
        printf("                                                                   +====================+\n");
        printf("\n\n                                  Enter LASTNAME:\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |%*s%s%*s|\n", leftPadding, "", lastName, boxWidth - textLen - leftPadding, "");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        break;
    }

    // DATE OF BIRTH
    while (1) {
        printf("\n\n                                  Date of Birth (DD/MM/YYYY):\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |                                                                                          |\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");

        printf("\n                                  Type here: ");
        if (scanf(" %[^\n]", birthD) != 1) { clear_stdin(); continue; }

        if (strlen(birthD) != 10 || birthD[2] != '/' || birthD[5] != '/') {
            printf("\n(System): Invalid date format! Use DD/MM/YYYY\n");
            getch();
            continue;
        }

        int boxWidth = 90;
        int textLen = strlen(birthD);
        int leftPadding = (boxWidth - textLen) / 2;

        system("cls");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                       * --------------------- / ---------------- /                       [ 9 ] Back  |\n");
        printf("                  |                              Personal Information     Account information     Position                               |\n");
        printf("                  +======================================================================================================================+\n");
        printf("                                                                   |Personal Information|\n");
        printf("                                                                   +====================+\n");
        printf("\n\n                                  Date of Birth (DD/MM/YYYY):\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |%*s%s%*s|\n", leftPadding, "", birthD, boxWidth - textLen - leftPadding, "");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        break;
    }

    // SEX
    while (1) {
        printf("\n\n                                  Sex at Birth (Male/Female):\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |                                                                                          |\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");

        printf("\n                                  Type here: ");
        if (scanf(" %[^\n]", sex) != 1) { clear_stdin(); continue; }

        sex[0] = toupper((unsigned char)sex[0]);
        for (int i = 1; sex[i]; i++) sex[i] = tolower((unsigned char)sex[i]);

        if (strcmp(sex, "Male") != 0 && strcmp(sex, "Female") != 0) {
            printf("\n(System): Please enter either 'Male' or 'Female'\n");
            getch();
            continue;
        }

        int boxWidth = 90;
        int textLen = strlen(sex);
        int leftPadding = (boxWidth - textLen) / 2;

        system("cls");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                              Personal Information     Account information     Position                               |\n");
        printf("                  +======================================================================================================================+\n");
        printf("\n\n                                  Sex at Birth (Male/Female):\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |%*s%s%*s|\n", leftPadding, "", sex, boxWidth - textLen - leftPadding, "");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        break;
    }

    // HOME ADDRESS (FIXED)
    system("cls");
    printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
    printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
    printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
    printf("                  |                                         Account Information Section                                                  |\n");
    printf("                  +======================================================================================================================+\n");
    printf("\n\n                                  Home Address:\n");
    printf("                                  ------------------------------------------------------------------------------------------\n");
    printf("                                 |                                                                                          |\n");
    printf("                                  ------------------------------------------------------------------------------------------\n");
    printf("\n                                  Type here: ");
    clear_stdin();
    if (!fgets(address, sizeof(address), stdin)) address[0] = '\0';
    address[strcspn(address, "\n")] = 0;
	 system("cls");
    int boxWidth = 90;
    int textLen = strlen(address);
    int leftPadding = (boxWidth - textLen) / 2;
    printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                       * --------------------- / ---------------- /                       [ 9 ] Back  |\n");
        printf("                  |                              Personal Information     Account information     Position                               |\n");
        printf("                  +======================================================================================================================+\n");
        printf("                                                                   |Personal Information|\n");
        printf("                                                                   +====================+\n");
        printf("\n\n                                     Home Address:\n");
    printf("\n                                  ------------------------------------------------------------------------------------------\n");
    printf("                                 |%*s%s%*s|\n", leftPadding, "", address, boxWidth - textLen - leftPadding, "");
    printf("                                  ------------------------------------------------------------------------------------------\n");
     
     
     while (1) {
        printf("\n\n                                  Enter Email:\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |                                                                                          |\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("\n                                  Type here: ");
        if (scanf(" %[^\n]", email) != 1) { clear_stdin(); continue; }

        if (! strchr(email, '@') || ! strchr (email,'.')) {
            printf("\n(System): Please enter @gmail.com (etc.).\n");
            getch();
            continue;
        }

        int boxWidth = 90;
        int textLen = strlen(email);
        int leftPadding = (boxWidth - textLen) / 2;

        system("cls");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                       * --------------------- / ---------------- /                       [ 9 ] Back  |\n");
        printf("                  |                              Personal Information     Account information     Position                               |\n");
        printf("                  +======================================================================================================================+\n");
        printf("                                                                   |Personal Information|\n");
        printf("                                                                   +====================+\n");
        printf("\n\n                                  Enter LASTNAME:\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |%*s%s%*s|\n", leftPadding, "", email, boxWidth - textLen - leftPadding, "");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        break;
    }

     
     
    // USERNAME (FIXED)
    while (1) {
    	
        printf("\n\n                                  Create Username:\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |                                                                                          |\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("\n                                  Type here: ");
        if (scanf(" %[^\n]", username) != 1) { clear_stdin(); continue; }

        if (strlen(username) < 4) {
            printf("\n(System): Username too short! Must be at least 4 characters.\n");
            getch();
            continue;
        }

        fp = fopen("accounts.txt", "r");
        if (fp) {
            struct Account tmp;
            int exists = 0;
            while (fscanf(fp, "%49[^,],%49[^,],%19[^,],%49[^,],%49[^,],%49[^\n]\n",
                          tmp.username, tmp.password, tmp.role, tmp.course, tmp.firstName, tmp.lastName) == 6) {
                if (strcmp(tmp.username, username) == 0) { exists = 1; break; }
            }
            fclose(fp);
            if (exists) {
                printf("\n(System): Username already exists.\n");
                getch();
                continue;
            }
        }
		system("cls");
        textLen = strlen(username);
        leftPadding = (boxWidth - textLen) / 2;
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                       * --------------------- / ---------------- /                       [ 9 ] Back  |\n");
        printf("                  |                              Personal Information     Account information     Position                               |\n");
        printf("                  +======================================================================================================================+\n");
        printf("                                                                   |Personal Information|\n");
        printf("                                                                   +====================+\n");
        printf("\n\n                                           Username:\n");
        printf("\n                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |%*s%s%*s|\n", leftPadding, "", username, boxWidth - textLen - leftPadding, "");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        break;
    }

    
    while (1) {
        printf("\n\n                                  Create Password:\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |                                                                                          |\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("\n                                  Type here: ");
        inputPassword(password);

        if (strlen(password) < 4) {
            printf("\n(System): Password too short!\n");
            getch();
            continue;
        }
		system("cls");
        textLen = strlen(password);
        leftPadding = (boxWidth - textLen) / 2;
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
        printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
        printf("                  |                                       * --------------------- / ---------------- /                       [ 9 ] Back  |\n");
        printf("                  |                              Personal Information     Account information     Position                               |\n");
        printf("                  +======================================================================================================================+\n");
        printf("                                                                   |Personal Information|\n");
        printf("                                                                   +====================+\n");
        printf("\n                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |%*s%s%*s|\n", leftPadding, "", "********", boxWidth - 8 - leftPadding, ""); // hide actual pass
        printf("                                  ------------------------------------------------------------------------------------------\n");

        printf("\n\n                                  Confirm Password:\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |                                                                                          |\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("\n                                  Type here: ");
        inputPassword(confirmPassword);

        if (strcmp(password, confirmPassword) != 0) {
            printf("\n(System): Passwords do not match!\n");
            getch();
            continue;
        }
        break;
    }

    // ROLE + COURSE (unchanged)
     while (1) {
        printf("\n\n                                  Role (Student/Faculty/Admin):\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("                                 |                                                                                          |\n");
        printf("                                  ------------------------------------------------------------------------------------------\n");
        printf("\n                                  Type here: ");
        if (scanf(" %[^\n]", role) != 1) { clear_stdin(); continue; }

        role[0] = toupper((unsigned char)role[0]);
        for (int i = 1; role[i]; i++) role[i] = tolower((unsigned char)role[i]);

        if (strcmp(role, "Student") != 0 && strcmp(role, "Faculty") != 0 && strcmp(role, "Admin") != 0) {
            printf("\n(System): Please enter either 'Student' or 'Faculty' and 'Admin'\n");
            getch();
            continue;
        }

        if (strcmp(role, "Faculty") == 0) {
            while (1) {
                system("cls");
                printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
                printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
                printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
                printf("                  |                                                 DEPARTMENT SELECTION                                                 |\n");
                printf("                  +====================================================================================================================+\n\n");
                printf("                                    ===========================================================================================\n");
                printf("                                    |               Please choose your course:                                                |\n");
                printf("                                    |-------------------------------------------------------------------------------------------|\n");
                printf("                                    |               [C] COMPUTER SCIENCE DEPARTMENT                                           |\n");
                printf("                                    |               [O] OFFFICE ADMINISTRATION DEPARTMENT                                     |\n");
                printf("                                    |               [T] TEACHER EDUCATION DEPARTMENT                                          |\n");
                printf("                                    ===========================================================================================\n\n");
                printf("                                                   Press [C], [O], or [T] to select your course.\n");
                printf("                                                   Press [9] to go back.\n");

                char ch = getch();

                if (ch == 'c' || ch == 'C')
                    strcpy(department, "COMPUTER SCIENCE DEPARTMENT");
                else if (ch == 'o' || ch == 'O')
                    strcpy(department, "OFFICE ADMINISTRATION DEPARTMENT");
                else if (ch == 't' || ch == 'T')
                    strcpy(department, "TEACHER EDUCATION DEPARTMENT");
                else if (ch == '9') {
                    system("cls");
                    printf("\n(System): Returning to role selection...\n");
                    Sleep(2000);
                    break;
                } else {
                    printf("\n(System): Invalid choice! Please try again.\n");
                    Sleep(1000);
                    continue;
                }

                printf("\nSelected Department: %s\n", department);
                Sleep(1000);
                break;
            }
        }

        if (strcmp(role, "Student") == 0) {
            while (1) {
                system("cls");
                printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
                printf("                  |                                                   PHILTECH GATEWAY                                                   |\n");
                printf("                  +----------------------------------------------------------------------------------------------------------------------+\n");
                printf("                  |                                                     COURSE SELECTION                                                 |\n");
                printf("                  +====================================================================================================================+\n\n");
                printf("                                    ===========================================================================================\n");
                printf("                                    |               Please choose your course:                                                |\n");
                printf("                                    |-------------------------------------------------------------------------------------------|\n");
                printf("                                    |               [1] BSCS      - Computer Science                                           |\n");
                printf("                                    |               [2] BSOA      - Office Administration                                      |\n");
                printf("                                    |               [3] BSVTVTED  - Vocational Tech Education                                  |\n");
                printf("                                    ===========================================================================================\n\n");
                printf("                                                   Press [1], [2], or [3] to select your course.\n");
                printf("                                                   Press [9] to go back.\n");

                char ch = getch();

                if (ch == '1') strcpy(course, "BSCS");
                else if (ch == '2') strcpy(course, "BSOA");
                else if (ch == '3') strcpy(course, "BSVTVTED");
                else if (ch == '9') {
                    system("cls");
                    printf("\n(System): Returning to Role selection...\n");
                    Sleep(1000);
                    continue;
                } else {
                    printf("\n(System): Invalid choice! Please press 1, 2, or 3.\n");
                    Sleep(1000);
                    continue;
                }

                int textLen = strlen(course);
                int leftPadding = (90 - textLen) / 2;

                system("cls");
                printf("\n\n                                  Course Selected:\n");
                printf("                                  ------------------------------------------------------------------------------------------\n");
                printf("                                 |%*s%s%*s|\n", leftPadding, "", course, 90 - textLen - leftPadding, "");
                printf("                                  ------------------------------------------------------------------------------------------\n");
                Sleep(1000);
                break;
            }
        } else {
            strcpy(course, "-");
            printf("\n(System): Staff role selected. No course required.\n");
            Sleep(1000);
        }
        break;
    }

    // ? Generate ID
    generateId(role, (strcmp(role, "Student") == 0) ? course : department, idNumber);
	system("cls");
    loadingScreen();

    // ? Save to file (with ID)
    fp = fopen("accounts.txt", "a");
    if (fp == NULL) {
        printf("\n(System): Unable to open file for writing.\n");
        return 0;
    }
    fprintf(fp, "%s,%s,%s,%s,%s,%s,%s\n",
            username, password, role, course, firstName, lastName, idNumber);
    fclose(fp);

    printf("\n\n(System): Account created successfully!\n");
    printf("Username: %s\n", username);
    printf("Role: %s %s\n", role, (strcmp(course, "-") == 0) ? "" : course);
    printf("Generated ID: %s\n", idNumber); 
    printf("Press any key to continue...");
    getch();

    return 0;
}











void inputPassword(char *pass) {
    int i = 0;
    char ch;
    while ((ch = getch()) != 13) {
        if (ch == 8 && i > 0) {
            printf("\b \b");
            i--;
        } else if (ch >= 32 && ch <= 126 && i < 49) {
            pass[i++] = ch;
            printf("*");
        }
    }
    pass[i] = '\0';
    printf("\n");
}











void loadingScreen() {
    int i;
    printf("Loading: ");
    for (i = 0; i <= 40; i++) {
        printf("%c", 219);
        Sleep(50);
    }
    printf(" 100%%\n");
}










void loginAccount() {
    struct Account acc;
    char username[50], password[50];
    int foundUser = 0, passwordMatch = 0, attempts = 0;
    
    FILE *fp;

    while (attempts < 3) {
        system("cls");
        fp = fopen("accounts.txt", "r");
        if (fp == NULL) {
            printf("\n(System): No accounts found. Please create one first.\n");
            getch();
            return;
        }

        printf("\n\nEnter Username: ");
        clear_stdin();
        if (!fgets(username, sizeof(username), stdin)) username[0] = '\0';
        username[strcspn(username, "\n")] = 0;

        printf("Enter Password: ");
        inputPassword(password);

        foundUser = 0;
        passwordMatch = 0;

        while (fscanf(fp, "%49[^,],%49[^,],%19[^,],%49[^,],%49[^,],%49[^\n]\n",
                      acc.username, acc.password, acc.role, acc.course, acc.firstName, acc.lastName) == 6) {
            if (strcmp(username, acc.username) == 0) {
                foundUser = 1;
                if (strcmp(password, acc.password) == 0) {
                    passwordMatch = 1;
                }
                break;
            }
        }
        fclose(fp);

        if (!foundUser) {
            printf("\n(System): Username not found!\n");
            attempts++;
        } else if (!passwordMatch) {
            printf("\n(System): Incorrect password!\n");
            attempts++;
        } else {
            printf("\n(System): Logging in...");
            Sleep(800);
            system("cls");
            loadingScreen();
            system("cls");
            printf("Login Successful! Welcome, %s (%s)", acc.username, acc.role,generateId);
            if (strcmp(acc.role, "Student") == 0 && strcmp(acc.course, "-") != 0)
                printf(" - %s", acc.course);
            	
            printf("\nPress any key to continue...");
            getch();
            return;
        }

        if (attempts < 3) {
            printf("\nAttempts left: %d\n", 3 - attempts);
            printf("Press any key to try again...");
            getch();
        } else {
            printf("\nToo many failed attempts. Returning to main menu...");
            Sleep(2000);
            return;
        }
    }
}








void forgotPassword() {
    struct Account acc;
    char username[50];
    int found = 0;
    FILE *fp = fopen("accounts.txt", "r");

    if (fp == NULL) {
        printf("\n(System): No accounts found.\n");
        getch();
        return;
    }

    printf("\nEnter your username to recover password: ");
    clear_stdin();
    if (!fgets(username, sizeof(username), stdin)) username[0] = '\0';
    username[strcspn(username, "\n")] = 0;

    while (fscanf(fp, "%49[^,],%49[^,],%19[^,],%49[^,],%49[^,],%49[^\n]\n",
                  acc.username, acc.password, acc.role, acc.course, acc.firstName, acc.lastName) == 6) {
        if (strcmp(username, acc.username) == 0) {
            found = 1;
            break;
        }
    }
    fclose(fp);

    if (found)
        printf("\n(System): Your password is: %s\n", acc.password);
    else
        printf("\n(System): Username not found.\n");

    printf("Press any key to return...");
    getch();
    
    
    
    
   
 
    
    
    
    
}








void generateId(const char* role, const char* department, char* idNumber) {
    srand(time(NULL));
    char prefix[5];
    int randomNum = rand() % 900000 + 100000; // 6-digit random number

    if (strcmp(role, "Student") == 0) {
        if (strstr(department, "Computer Science") || strstr(department, "BSCS"))
            strcpy(prefix, "CS");
        else if (strstr(department, "Office") || strstr(department, "BSOA"))
            strcpy(prefix, "OA");
        else if (strstr(department, "Teacher") || strstr(department, "BSVTVTED"))
            strcpy(prefix, "ED");
        else
            strcpy(prefix, "STU");
    } else if (strcmp(role, "Faculty") == 0) {
        strcpy(prefix, "FAC");
    } else if (strcmp(role, "Admin") == 0) {
        strcpy(prefix, "ADM");
    } else {
        strcpy(prefix, "GEN");
    }

    sprintf(idNumber, "%s-%d", prefix, randomNum);
}




 
